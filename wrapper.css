:root{
  /* Tweakables */
  --ui-scale: 1.3;                /* overall control scale for phones */
  --ui-opacity: 0.96;             /* control bar opacity */
  --zone-width: min(64vw, 78vmin);/* width of the touch zone */
  --zone-height: min(64vw, 78vmin);
  --ring-size: min(46vmin, 60vw); /* max diameter of the visible ring */
  --knob-size: 34%;               /* knob radius relative to ring */
  --btn-size: clamp(64px, 18vmin, 110px);

  /* Game Boy-ish colors */
  --body: #bfc5a7;
  --screen: #2b3a1a;
  --screen-glow: #3d5226;

  --glass: rgba(18,18,18,0.45);
  --glass-strong: rgba(18,18,18,0.65);
  --border: rgba(255,255,255,0.28);
  --active: rgba(255,255,255,0.5);

  --safe-bottom: env(safe-area-inset-bottom, 12px);
  --safe-top: env(safe-area-inset-top, 10px);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;overscroll-behavior:none;background:#0b0e11;color:#e8f0f2;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial,Noto Sans,sans-serif}
#wrap{position:fixed;inset:0;display:grid;grid-template-rows:1fr auto}

/* Stage / game frame */
#stage{position:relative;overflow:hidden;background:var(--body)}
.bezel{position:absolute;inset:0;display:grid;place-items:center;padding:clamp(8px,2.5vmin,18px);
  background: radial-gradient(180vmax 120vmax at 30% -20%, #d4d9be 10%, var(--body) 60%, #aab094 100%)}
#gameframe{width:100%;height:100%;border:0;background:linear-gradient(180deg,var(--screen-glow),var(--screen));
  border-radius: clamp(8px, 1.6vmin, 14px); box-shadow: 0 0 0 4px rgba(0,0,0,0.15) inset, 0 14px 26px rgba(0,0,0,0.35)}

/* Starter overlay */
#starter{position:absolute;inset:0;display:grid;place-items:center;background:radial-gradient(120vmax 120vmax at 50% 50%,rgba(0,0,0,.78),rgba(0,0,0,.92));z-index:10}
#starter .card{padding:18px 22px;text-align:center;border-radius:18px;background:var(--glass);border:1px solid var(--border);backdrop-filter:blur(6px)}
#starter .title{font-weight:800;margin-bottom:6px}
#starter .sub{opacity:.8;margin-bottom:12px}
.btn{display:inline-grid;place-items:center;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,0.12);color:#fff;cursor:pointer;user-select:none}
.btn.pill{padding:12px 20px;font-weight:700}
.btn.ghost{background:rgba(255,255,255,0.08)}
.btn:active,.btn.active{background:var(--active);border-color:#fff}

/* Top bar */
#topbar{position:absolute;left:10px;right:10px;top:var(--safe-top);display:flex;gap:10px;justify-content:flex-end;z-index:5}
#topbar .btn{padding:6px 10px;border-radius:999px}

/* Control bar */
#controls{position:relative;padding:14px 16px calc(22px + var(--safe-bottom));
  background:linear-gradient(to top, rgba(0,0,0,0.55), rgba(0,0,0,0.25));
  touch-action:none}
#controlInner{
  display:flex;justify-content:center;align-items:flex-end;
  gap: clamp(16px, 4vw, 42px);
  transform: scale(var(--ui-scale)); transform-origin: bottom center;
  opacity: var(--ui-opacity); transition: transform .15s ease, opacity .15s ease;
}

/* Touchpad zone */
.touchzone{
  position:relative; width:var(--zone-width); height:var(--zone-height);
  max-width:580px; max-height:580px; border-radius:24px;
  background: var(--glass-strong); border:1px solid var(--border); backdrop-filter: blur(6px);
  box-shadow: 0 10px 24px rgba(0,0,0,.35) inset, 0 4px 18px rgba(0,0,0,.35);
  overflow:hidden;
}
.touchzone .ring{
  position:absolute; width:var(--ring-size); height:var(--ring-size); border-radius:50%;
  border:1px solid var(--border);
  background: rgba(255,255,255,0.06);
  left: 50%; top: 50%; transform: translate(-50%,-50%);
  pointer-events:none;
}
.touchzone .knob{
  position:absolute; width:var(--ring-size); height:var(--ring-size); border-radius:50%;
  left: 50%; top: 50%; transform: translate(-50%,-50%);
  pointer-events:none;
}
.touchzone .knob::after{
  content:""; position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  width: var(--knob-size); height: var(--knob-size); border-radius:50%;
  background: rgba(255,255,255,0.14); border:1px solid var(--border);
  box-shadow: 0 6px 18px rgba(0,0,0,.35) inset, 0 2px 8px rgba(0,0,0,.35);
}

/* Actions */
.actions{display:grid;grid-template-columns:1fr;gap:14px;align-items:end}
.actions .action{
  width:var(--btn-size); height:var(--btn-size);
  font-size: clamp(18px, 5.5vmin, 24px); font-weight:900;
  box-shadow: 0 6px 18px rgba(0,0,0,.35) inset, 0 2px 8px rgba(0,0,0,.35);
  background: rgba(255,255,255,0.14);
}
.actions .full{width:var(--btn-size); height:calc(var(--btn-size) * .6); border-radius:14px}

/* Settings dialog */
dialog#settings{width:min(560px, 94vw); border:1px solid var(--border); border-radius:16px;
  padding:16px; background:var(--glass); color:#fff; backdrop-filter:blur(8px)}
dialog::backdrop{background:rgba(0,0,0,.5)}
#settings h3{margin:0 0 10px 0}
#settings .row{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:10px 0}
#settings input[type="range"], #settings select{width:54%}
#settings .buttons{justify-content:flex-end}
#settings .btn{padding:8px 14px}
#settings .btn.ghost{background:rgba(255,255,255,0.08)}
#settings .hint{opacity:.75;margin-top:8px;font-size:.9em}

/* Left-handed layout */
.lefty #controlInner{flex-direction: row-reverse}
